branches:
  only:
    - master

jobs:
  fast_finish: true
  include:
    - stage: "style check"
      python: '3.7'
      os: linux
      language: python
      script: flake8
    - stage: "unit tests"
      python: '2.7'
      os: linux
      language: python
    - python: '3.5'
      os: linux
      language: python
    - python: '3.6'
      os: linux
      language: python
    - python: '3.7'
      os: linux
      language: python

install:
  - pip install --upgrade matplotlib
  - pip install --upgrade numpy
  - pip install --upgrade pandas
  - pip install --upgrade pydot
  - pip install --upgrade pytest
  - pip install --upgrade codecov
  - pip install --upgrade flake8
  - pip install --upgrade pep8-naming
  - python setup.py install

script:
  - PYTHONPATH=. coverage run $(which pytest)

after_success:
  - codecov --env PYTHON_VERSION --required --flags "${TEST_SUITE}${TRAVIS_OS_NAME}"

notifications:
  email:
    recipients: bhatele@llnl.gov
    on_success: change
    on_failure: always
